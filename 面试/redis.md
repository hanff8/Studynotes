## 1. redis的慢查询使用的是什么数据结构
Redis的慢查询功能使用了一个数据结构称为"慢查询日志"（Slow Log）。慢查询日志是一种记录Redis执行时间较长的命令的数据结构，它用于帮助识别和分析性能问题。

慢查询日志在Redis中是一个有序列表（Sorted List）。每当一个命令的执行时间超过了预定义的阈值（通过`slowlog-log-slower-than`配置项设置），Redis就会将该命令的相关信息添加到慢查询日志中。慢查询日志中的每个条目都包含了以下信息：

- 时间戳：命令执行的时间戳。
- 执行时间：命令的实际执行时间（以微秒为单位）。
- 命令：被执行的命令以及参数。

通过查看慢查询日志，管理员可以识别哪些命令在执行时引发了性能瓶颈，并采取适当的措施来优化这些命令，从而提高Redis的性能。

你可以使用`SLOWLOG`命令来查看和管理慢查询日志，例如，使用`SLOWLOG GET`来获取慢查询日志的条目，或使用`SLOWLOG LEN`来获取日志中的条目数量。

总之，Redis的慢查询功能使用有序列表作为数据结构，用于记录执行时间较长的命令，以帮助用户识别和解决性能问题。
## 2. redis支持事务吗，那他支持回滚吗？
是的，Redis 支持事务。Redis 提供了 MULTI、EXEC、DISCARD 和 WATCH 等命令，以便执行事务操作。

1. MULTI：用于标志一个事务块的开始。在执行 MULTI 命令后，后续的命令都会被视为事务中的一部分。

2. EXEC：用于执行事务中的所有命令。如果在 EXEC 执行之前没有出现任何错误，Redis 会执行所有事务命令并将结果返回。

3. DISCARD：用于取消事务，清除事务队列中的所有命令。执行 DISCARD 后，之前的 MULTI 命令的效果将被撤销。

4. WATCH：用于监视一个或多个键，如果在事务执行期间被其他客户端修改，事务将被取消。

在执行事务时，如果在 EXEC 命令执行期间没有发生错误，并且没有其他客户端修改了被 WATCH 监视的键，那么事务会成功执行。但是，如果在事务执行期间发生了错误（例如语法错误），或者被 WATCH 监视的键被其他客户端修改，那么事务会被取消，不会对数据进行任何修改。

因此，Redis 支持事务和回滚，当事务执行失败或被取消时，不会对数据产生影响。需要注意的是，Redis 的事务是乐观锁，它不会阻止其他客户端在事务执行期间修改被监视的键，只是在执行 EXEC 命令时检查是否发生了冲突。如果检测到冲突，事务将被取消，开发人员需要处理这种情况。